	<!doctype html>
	<html>

	<head>
		<script src="https://w.soundcloud.com/player/api.js"></script>
	</head>

	<body>
		<script>
			(async () => {
				
				const params = new Proxy(new URLSearchParams(window.location.search), {
  					get: (searchParams, prop) => searchParams.get(prop),
				});

				const audioTrack = `https://soundcloud.com/${params.track}`
				const shouldPlay = params.play

				const response = await fetch(`https://soundcloud.com/oembed?format=json&url=${audioTrack}`)
				const json = await response.json()

				if (!!json && !!json.html) {
					const container = document.createElement('div');
					container.innerHTML = json.html;

					document.body.appendChild(container)
					document.body.style.overflow = 'hidden';

					const frame = container.firstElementChild
					var player = SC.Widget(frame);

					player.bind(SC.Widget.Events.ERROR, function (err) {
						console.log(err)
					})

					player.bind(SC.Widget.Events.READY, function () {
						var totalDuration = 0
						var curVol = 0
						var curTime = 0

						player.getDuration((duration) => {
							totalDuration = duration

							if (shouldPlay) {
								frame.setAttribute("height", window.innerHeight)

								setInterval(function () {
									player.getVolume((volume) => { curVol = volume });
									player.getPosition((currentTime) => { curTime = currentTime });
								}, 100);

								{ // Native audio controll
									player.currentTime = 0;
									player.duration = 0;

									Object.defineProperty(player, "currentTime", {
										get() {
											return curTime / 1000;
										},
										set(time) {
											player.seekTo(time * 1000);
										},
									});

									Object.defineProperty(player, "duration", {
										get() {
											return totalDuration / 1000;
										},
									});

									player.play()
									window.MediaPlayer = player

								}
							} else {
								var metadata = {
									duration: Math.round(totalDuration / 1000),
									title: json.title
								}

								console.log("METADATA:" + JSON.stringify(metadata))
							}
						});
					});
				}
			})()

		</script>
	</body>

	</html>